<!DOCTYPE html>
<html lang="he" dir="rtl">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, viewport-fit=cover">
    <meta name="mobile-web-app-capable" content="yes">
    <meta name="apple-mobile-web-app-capable" content="yes">
    <meta name="apple-mobile-web-app-status-bar-style" content="default">
    <meta name="theme-color" content="#fdfbf7">
    <meta name="description" content="איכות | פשטות רדיקלית לבני אדם מאת שרון אייכלר">
    <meta name="author" content="שרון אייכלר">
    <title>איכות | פשטות רדיקלית לבני אדם</title>
    <link rel="stylesheet" href="css/book.css">
</head>
<body>
    <button class="mobile-nav-toggle" aria-label="פתח/סגור תפריט">
        <span></span>
        <span></span>
        <span></span>
    </button>
    <div class="sidebar-overlay"></div>

    <div class="site-container">
        <nav class="sidebar" role="navigation" aria-label="תוכן עניינים">
            <header class="site-header">
                <h1 class="book-title">פשטות רדיקלית<br>לבני אדם</h1>
                <p class="book-subtitle">שכבה 8</p>
                <div class="author-info">
                    <p>שרון אייכלר</p>
                    <p><a href="mailto:saichler@gmail.com">saichler@gmail.com</a></p>
                </div>
                <div class="sponsor-button">
                    <iframe src="https://github.com/sponsors/saichler/button" title="Sponsor saichler" height="32" width="114" style="border: 0; border-radius: 6px;"></iframe>
                </div>
            </header>

            <h2 class="nav-title">תוכן עניינים</h2>
            <ul class="chapter-list">
                <li><a href="book.html">בית</a></li>
                <li><a href="about.html">אודות המחבר</a></li>
                <li><a href="introduction.html">מבוא</a></li>
                <li><a href="thoughts.html">מחשבות</a></li>
                <li><a href="ground-rules.html">כללי יסוד</a></li>
                <li><a href="architecture.html">ארכיטקטורה כמנגנון יישור</a></li>
                <li><a href="failure-modes.html">מצבי כשל</a></li>
                <li><a href="economics.html">כלכלה</a></li>
                <li><a href="security.html">אבטחה</a></li>
                <li><a href="networking.html">רשתות</a></li>
                <li><a href="serialization.html">סריאליזציה</a></li>
                <li><a href="model-agnostic-runtime.html">זמן ריצה אגנוסטי למודל</a></li>
                <li><a href="service-as-contract.html">שירות כחוזה</a></li>
                <li><a href="api-query-language.html">API ושפת שאילתות</a></li>
                <li><a href="object-relation-mapping.html">מיפוי יחסי אובייקטים</a></li>
                <li><a href="web-server.html">שרת אינטרנט</a></li>
                <li><a href="quality.html" class="active">איכות</a></li>
                <li><a href="practice.html">תרגול</a></li>
                <li><span class="coming-soon">פשטות רדיקלית ל-AI</span></li>
                <li><span class="coming-soon">מיגרציה</span></li>
            </ul>
        </nav>

        <main class="main-content">
            <div class="content-wrapper">
                <article>
                    <h1>איכות</h1>

                    <p>"זה קשה מדי לבדיקה."<br>
                    "בדיקת זה תיקח לפחות שבועיים."<br>
                    "אני לא יכול לבדוק את זה על הלפטופ שלי - אין מספיק משאבים."<br>
                    "אני לא יכול לבדוק את זה מקומית - זה מתוכנן ללינוקס ואני על Windows."<br>
                    "אני לא יכול לבדוק את זה בלי Kubernetes."<br>
                    "אני לא יכול לשחזר את הבעיה בלי שלוש מכונות."<br>
                    "אני לא יכול לבדוק את זה כי השירותים התלויים שייכים לצוות אחר."</p>

                    <p>הרשימה לעולם לא נגמרת באמת.</p>

                    <p>אלה לא בעיות בדיקה. אלה בעיות ארכיטקטוניות.</p>

                    <p>בדיקות מוצגות לעתים קרובות כבעיית משמעת, בעיית כלים או בעיית זמן.</p>

                    <p>זה לא אף אחד מאלה.<br>
                    בדיקות הן בעיית תכנון.</p>

                    <p>איכות קשורה ישירות לאיזון עבודה/חיים. ככל שרשת הביטחון חזקה יותר, כך יש פחות פחד משינוי. ככל שיש פחות פחד משינוי, כך פיצ'רים מגיעים מהר יותר ובאגים מתוקנים, ללא רגרסיות.</p>

                    <p>כולם מסכימים עם זה בתיאוריה. מנהלים חוזרים על זה. המנהלים שלהם חוזרים על זה שוב. ובכל זאת אותם תירוצים נמשכים.</p>

                    <p>לא כי מהנדסים לא אכפת להם מאיכות, אלא כי המערכות שהם עובדים איתן <strong>עושות את האיכות ליקרה.</strong></p>

                    <p>בשכבה 8, איכות אינה נאכפת על ידי תהליך. היא מופעלת על ידי ארכיטקטורה.</p>

                    <p>פרק זה לא על כתיבת יותר בדיקות. הוא על תכנון מערכות שקל לבדוק, קל להבין וקשה לשבור.</p>

                    <hr>

                    <h2>כלל 10 הדקות</h2>

                    <p>המטרה של שכבה 8 פשוטה: אתה צריך להיות מסוגל להוסיף בדיקה משמעותית לכל פונקציונליות בעשר דקות או פחות.</p>

                    <p>זה לא תרגיל עם שעון עצר. זה אות תכנון.</p>

                    <p>כן, הכלל סובייקטיבי. חמש-עשרה או אפילו עשרים דקות בדרך כלל מקובלים. אבל אם כתיבת בדיקה לוקחת באופן עקבי ארבעים דקות או יותר, משהו לא בסדר.</p>

                    <p>או:</p>

                    <ul>
                        <li>התכנון נלחם בך, או</li>
                        <li>למסגרת חסרה אבסטרקציה שאמורה לעשות את העבודה הכבדה.</li>
                    </ul>

                    <p>בשכבה 8, בדיקות הן קוד מדרגה ראשונה. הן חיות בנתיב הראשי, לא בצד.</p>

                    <p>אותם כללים חלים:</p>
                    <ul>
                        <li>שמור אותן פשוטות,</li>
                        <li>הימנע מחזרה,</li>
                        <li>הפשט אתגרים חוזרים,</li>
                        <li>ולעולם אל תשכפל מאמץ.</li>
                    </ul>

                    <p>כשבדיקות מהירות, ניסויים הופכים לבטוחים. כשניסויים בטוחים, איכות מפסיקה להיות מס והופכת להרגל.</p>

                    <hr>

                    <h2>דטרמיניזם אינו אופציונלי</h2>

                    <p>מהירות לבדה לא יוצרת איכות.</p>

                    <p>בדיקה שהיא מהירה אך בלתי צפויה גרועה מאי-קיום בדיקה בכלל. היא שוחקת אמון, מכריחה ניסיונות חוזרים ומלמדת לאט מהנדסים להתעלם מכשלונות.</p>

                    <p>כדי שכלל 10 הדקות יהיה משמעותי, בדיקות חייבות להיות דטרמיניסטיות.</p>

                    <p>בהינתן אותם קלטים, בדיקה חייבת לייצר את אותה תוצאה. בכל פעם. בכל מכונה.</p>

                    <p>אם בדיקה לפעמים עוברת ולפעמים נכשלת, הבעיה היא לא הבדיקה. היא הארכיטקטורה.</p>

                    <p>שכבה 8 מתייחסת לדטרמיניזם כאילוץ תכנון.</p>
                    <ul>
                        <li>תלויות תזמון,</li>
                        <li>סדר משתמע,</li>
                        <li>מצב נסתר,</li>
                        <li>והתנהגות ספציפית לסביבה</li>
                    </ul>

                    <p><strong>הם ריחות ארכיטקטוניים, לא מקרי קצה.</strong></p>

                    <h3>הגדרת דטרמיניזם</h3>

                    <p>דטרמיניזם בהקשר של בדיקות שכבה 8 אומר:</p>

                    <p>עבור בדיקה נתונה, כאשר מסופקים אותם קלטים מוצהרים, קונפיגורציה ומצב מערכת התחלתי, ביצוע מייצר אותה התנהגות ותוצאות נצפות, ללא תלות בתזמון, סדר ביצוע, סביבה, חומרה, מערכת הפעלה או היסטוריית בדיקות קודמת.</p>

                    <p>באופן קונקרטי יותר, בדיקה היא דטרמיניסטית אם ורק אם:</p>

                    <ul>
                        <li>מצב התחלתי הוא מפורש וזהה לכל ביצוע</li>
                        <li>כל התלויות מוצהרות ומבוקרות</li>
                        <li>ביצוע לא מסתמך על זמן קיר או תנאי מרוץ</li>
                        <li>תוצאות נצפות יציבות וחוזרות</li>
                    </ul>

                    <p>כל בדיקה שתוצאתה משתנה ללא שינוי קלט היא לא-דטרמיניסטית בהגדרה ומצביעה על פגם ארכיטקטוני ולא על פגם בדיקות.</p>

                    <p>מכיוון ששכבה 8 היא אגנוסטית לפלטפורמה, בדיקות מתבצעות בסביבה מקומית אמיתית, לא בסימולציה.</p>

                    <hr>

                    <h2>מה שכבה 8 מספקת כסביבת בדיקות</h2>

                    <p>שכבה 8 מספקת סביבת ביצוע מקומית אמיתית שתוכננה להפעיל התנהגות מערכת מבוזרת על מכונה פיזית יחידה. מכיוון ששכבה 8 היא אגנוסטית לפלטפורמה, אותה סביבה רצה ללא שינוי על כל מערכת הפעלה, מאפשרת לשירותי production לרוץ מקומית לפני פריסה.</p>

                    <p>סביבת הבדיקות אינה סימולציה ואינה אוסף של מכונות עצמאיות; היא מערכת מקומית יחידה שמרכיבה טופולוגיה מבוזרת אמיתית, מאפשרת לשירותים לחוות גבולות רשת אמיתיים, מקביליות והתנהגות כשל בתנאים מבוקרים וחוזרים.</p>

                    <p>באופן ספציפי, הסביבה בונה:</p>

                    <ul>
                        <li>שלוש רשתות וירטואליות (VNets), כל אחת מייצגת מכונה נפרדת.</li>
                        <li>fabric רשת מאוחד המורכב מ-VNets אלה, מאפשר תקשורת בין-רשתית אמיתית תוך ביצוע על host יחיד.</li>
                        <li>ארבעה ממשקי רשת וירטואליים (vNICs) לכל VNet, מה שמביא לטופולוגיה קבועה של שלוש מכונות, כל אחת מארחת ארבעה הקשרי ביצוע מבודדים.</li>
                    </ul>

                    <p>בסך הכל, הסביבה חושפת שנים-עשר vNICs, כל אחד פועל כנקודת חיבור יציבה וניתנת לכתובת לביצוע שירות.</p>

                    <h3>מחזור חיים מונע בדיקות</h3>

                    <p>כשבדיקה מתחילה, המערכת נקייה.</p>

                    <ul>
                        <li>אין שירותים רצים.</li>
                        <li>אין מצב מורש.</li>
                        <li>אין טופולוגיה מאוכלסת באופן משתמע.</li>
                    </ul>

                    <p>הבדיקה מפעילה באופן מפורש שירותים על vNICs נבחרים, ובכך בוחרת:</p>

                    <ul>
                        <li>איפה שירות רץ,</li>
                        <li>לאיזו מכונה הוא שייך,</li>
                        <li>ואילו גבולות רשת הוא חייב לחצות.</li>
                    </ul>

                    <p>הבדיקה מתקשרת עם שירותים אך ורק דרך ממשקי ה-vNIC שלהם, באמצעות אותם API ופרוטוקולים שישמשו ב-production.</p>

                    <p>כשהבדיקה מסתיימת, הסביבה מבטלת את השירותים שנבדקו ומנקה את מצבם, תוך שמירה על הטופולוגיה.</p>

                    <p>אף בדיקה לא יכולה להשפיע על אחרת.<br>
                    אין מצב נסתר שנשמר בין ריצות.</p>

                    <p>דטרמיניזם מושג לא על ידי mocking או הגבלה, אלא על ידי שליטה מלאה על טופולוגיה, הפעלה ומחזור חיים.</p>

                    <hr>

                    <h2>עצמאות מצוותים אחרים</h2>

                    <p>כשלונות בדיקות רבים מוסווים כבעיות ארגוניות.</p>

                    <blockquote>"אני לא יכול לבדוק את זה כי צוות אחר מחזיק בתלות"</blockquote>

                    <p>היא לא בעיית תיאום. היא בעיה ארכיטקטונית.</p>

                    <p>בשכבה 8, שירותים מתוכננים להיות ניתנים לבדיקה בבידוד. חוזים מפורשים. התנהגות מוצהרת. תלויות נראות ומכוונות.</p>

                    <p>בדיקה משמעותית לעולם לא תלויה בזמינות של צוות אחר כדי לאמת נכונות. מכיוון ששכבה 8 בנויה סביב SLA של שירותים, כל תלות כבר מוגדרת על ידי חוזה.</p>

                    <p>Mocks לא נדרשים. Mocks נסחפים.</p>

                    <p>במקום זאת, שירותים אמיתיים מבוצעים מקומית, תחת חוזים אמיתיים, בתוך טופולוגיה מוצהרת.</p>

                    <p>תלויות בין-צוותיות מפסיקות להיות חוסמים. הן הופכות לקלטים מוצהרים.</p>

                    <hr>

                    <h2>בדיקות כארכיטקטורה בת-ביצוע</h2>

                    <p>בשכבה 8, בדיקות הן יותר מבדיקות רגרסיה. הן הוכחה בת-ביצוע שהארכיטקטורה מתנהגת כמתוכנן.</p>

                    <p>בדיקות הן לא תיעוד. הן הצורה הרצה של הארכיטקטורה.</p>

                    <p>דיאגרמה יכולה לתאר כוונה. מסמך יכול להסביר כוונה. רק בדיקה יכולה להוכיח כוונה תחת ביצוע.</p>

                    <p>בשכבה 8, לכל כלל ארכיטקטוני משמעותי חייבת להיות בדיקה מתאימה. אם לא ניתן להפעיל ולאמת אותו אוטומטית, זה לא כלל. זו הנחה.</p>

                    <p>בדיקות מאמתות באופן רציף:</p>

                    <ul>
                        <li>חוזי שירות,</li>
                        <li>ערבויות מחזור חיים,</li>
                        <li>בעלות מקביליות בגבולות אובייקט ראשי,</li>
                        <li>התנהגות נצפית מוגדרת SLA,</li>
                        <li>טיפול בכשלים ונתיבי התאוששות.</li>
                    </ul>

                    <p>כשבדיקה נכשלת, זה לא רק באג בקוד. זו עדות שהארכיטקטורה כבר לא מתנהגת כמתוכנן.</p>

                    <p>הדרך המהירה ביותר לזהות סחיפה ארכיטקטונית היא לא review או פגישה. זו הרצת בדיקה.</p>

                    <hr>

                    <h2>סגירת מצב כשל שבירות בדיקות</h2>

                    <p>פרק 04 זיהה שבירות בדיקות כמצב כשל מרכזי של ארכיטקטורה משתמעת.</p>

                    <p>בדיקות הופכות לשבירות כשהן מקודדות הנחות שהארכיטקטורה לא אוכפת:</p>
                    <ul>
                        <li>סדר משתמע,</li>
                        <li>מצב משותף ומשתנה,</li>
                        <li>תלויות תזמון,</li>
                        <li>התנהגות ספציפית לסביבה,</li>
                        <li>וצימוד נסתר.</li>
                    </ul>

                    <p>ככל שמערכות מתפתחות, הנחות אלה נשברות. בדיקות נכשלות לא כי ההתנהגות שגויה, אלא כי מבנה לא מתועד השתנה.</p>

                    <p>זה מוביל לתוצאה צפויה:</p>
                    <ul>
                        <li>בדיקות מורצות מחדש,</li>
                        <li>מוכנסות להסגר,</li>
                        <li>נכתבות מחדש,</li>
                        <li>או נמחקות.</li>
                    </ul>

                    <p><strong>בסופו של דבר, מפסיקים לסמוך עליהן.</strong></p>

                    <p>שכבה 8 סוגרת את מצב כשל זה ארכיטקטונית.</p>

                    <p>מכיוון שבדיקות מבוצעות תחת אותם אילוצים ארכיטקטוניים כמו שירותי production, הן מאמתות את הארכיטקטורה עצמה. בדיקות שבירות נכשלות כי המערכת השתנתה.</p>

                    <p>בדיקות שכבה 8 נכשלות כי הארכיטקטורה נשברה.</p>

                    <p>על ידי ביטול מבנה משתמע, שכבה 8 מבטלת שבירות בדיקות במקור שלה.</p>

                    <hr>

                    <h2>כש-Production כבר לא סביבת הבדיקות</h2>

                    <p>במערכות מבוזרות מסורתיות, התנהגויות מסוימות צומחות רק תחת עומס אמיתי, מקביליות אמיתית ותנאי כשל אמיתיים.</p>

                    <p>מכיוון שתנאים אלה קשים לשחזור מקומית, production הופך למקום שבו התנהגות מתגלה. משתמשים הופכים למשתתפי בדיקות. תקלות הופכות ל-feedback.</p>

                    <p>שכבה 8 משנה את המודל הזה.</p>

                    <p>התנהגות מבוזרת מופעלת מקומית לפני פריסה, תחת אותם אילוצים ארכיטקטוניים שקיימים ב-production.</p>

                    <p>כתוצאה מכך, production כבר לא המקום שבו התנהגות מתגלה. זה המקום שבו התנהגות מבוצעת בביטחון.</p>

                    <p>מחלקה של כשלונות שבעבר דרשה cluster staging או traffic production יכולה עכשיו להיות מופעלת מקומית.</p>

                    <p>מגבלות מקביליות, התנהגות retry והפרות SLA מופעלות בכוונה, נצפות באופן דטרמיניסטי ומתוקנות לפני פריסה.</p>

                    <nav class="chapter-nav">
                        <a href="web-server.html" class="prev">שרת אינטרנט</a>
                        <a href="practice.html" class="next">תרגול</a>
                    </nav>
                </article>
            </div>
        </main>
    </div>

    <script src="js/book.js"></script>
</body>
</html>
